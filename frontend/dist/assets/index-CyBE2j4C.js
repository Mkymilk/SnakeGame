(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();var a=(r=>(r.UP="UP",r.DOWN="DOWN",r.LEFT="LEFT",r.RIGHT="RIGHT",r))(a||{}),i=(r=>(r.MENU="MENU",r.GAME="GAME",r.OPTIONS="OPTIONS",r.GAME_OVER="GAME_OVER",r.LEADERBOARD="LEADERBOARD",r.PAUSE="PAUSE",r))(i||{});class p{constructor(e,t){this.gameLoop=null,this.lastMoveTime=0,this.canvas=e,this.ctx=e.getContext("2d"),this.settings=t,this.canvas.width=t.canvasWidth,this.canvas.height=t.canvasHeight,this.state=this.createInitialState(),this.setupRendering()}createInitialState(){const e=Math.floor(this.settings.gridSize/2),t=Math.floor(this.settings.gridSize/2);return{snake:[{x:e,y:t},{x:e-1,y:t},{x:e-2,y:t}],food:this.generateFood([]),direction:a.RIGHT,nextDirection:a.RIGHT,score:0,isGameOver:!1,isPaused:!1,speed:this.settings.initialSpeed,wallMode:this.settings.wallMode,soundEnabled:this.settings.soundEnabled}}setupRendering(){this.ctx.imageSmoothingEnabled=!1}generateFood(e){let t;do t={x:Math.floor(Math.random()*this.settings.gridSize),y:Math.floor(Math.random()*this.settings.gridSize)};while(e.some(o=>o.x===t.x&&o.y===t.y));return t}changeDirection(e){({[a.UP]:a.DOWN,[a.DOWN]:a.UP,[a.LEFT]:a.RIGHT,[a.RIGHT]:a.LEFT})[this.state.direction]!==e&&(this.state.nextDirection=e)}start(){this.gameLoop||(this.lastMoveTime=Date.now(),this.gameLoop=requestAnimationFrame(()=>this.update()))}stop(){this.gameLoop&&(cancelAnimationFrame(this.gameLoop),this.gameLoop=null)}pause(){this.state.isPaused=!0,this.stop()}resume(){this.state.isPaused=!1,this.start()}reset(){this.stop(),this.state=this.createInitialState(),this.render()}updateSettings(e){Object.assign(this.settings,e),this.state.speed=e.initialSpeed||this.state.speed,this.state.wallMode=e.wallMode||this.state.wallMode,this.state.soundEnabled=e.soundEnabled??this.state.soundEnabled}getState(){return{...this.state}}update(){const e=Date.now(),t=1e3/this.state.speed;e-this.lastMoveTime>=t&&(this.move(),this.lastMoveTime=e),this.render(),!this.state.isGameOver&&!this.state.isPaused&&(this.gameLoop=requestAnimationFrame(()=>this.update()))}move(){if(this.state.isGameOver||this.state.isPaused)return;this.state.direction=this.state.nextDirection;const e={...this.state.snake[0]};switch(this.state.direction){case a.UP:e.y--;break;case a.DOWN:e.y++;break;case a.LEFT:e.x--;break;case a.RIGHT:e.x++;break}if(this.state.wallMode==="wrap")e.x=(e.x+this.settings.gridSize)%this.settings.gridSize,e.y=(e.y+this.settings.gridSize)%this.settings.gridSize;else if(e.x<0||e.x>=this.settings.gridSize||e.y<0||e.y>=this.settings.gridSize){this.state.isGameOver=!0;return}if(this.state.snake.some(t=>t.x===e.x&&t.y===e.y)){this.state.isGameOver=!0;return}this.state.snake.unshift(e),e.x===this.state.food.x&&e.y===this.state.food.y?(this.state.score+=10,this.state.food=this.generateFood(this.state.snake),this.state.speed=Math.min(this.state.speed+.1,15)):this.state.snake.pop()}render(){this.ctx.fillStyle="#1a2e1a",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="#2a4a2a",this.ctx.lineWidth=1;for(let o=0;o<=this.settings.gridSize;o++){const s=o*this.settings.cellSize;this.ctx.beginPath(),this.ctx.moveTo(s,0),this.ctx.lineTo(s,this.canvas.height),this.ctx.stroke()}for(let o=0;o<=this.settings.gridSize;o++){const s=o*this.settings.cellSize;this.ctx.beginPath(),this.ctx.moveTo(0,s),this.ctx.lineTo(this.canvas.width,s),this.ctx.stroke()}this.state.snake.forEach((o,s)=>{const n=o.x*this.settings.cellSize,c=o.y*this.settings.cellSize;if(s===0){this.ctx.fillStyle="#90EE90",this.ctx.fillRect(n+1,c+1,this.settings.cellSize-2,this.settings.cellSize-2),this.ctx.fillStyle="#000";const l=2,h=3;switch(this.state.direction){case a.UP:this.ctx.fillRect(n+h,c+2,l,l),this.ctx.fillRect(n+this.settings.cellSize-h-l,c+2,l,l);break;case a.DOWN:this.ctx.fillRect(n+h,c+this.settings.cellSize-4,l,l),this.ctx.fillRect(n+this.settings.cellSize-h-l,c+this.settings.cellSize-4,l,l);break;case a.LEFT:this.ctx.fillRect(n+2,c+h,l,l),this.ctx.fillRect(n+2,c+this.settings.cellSize-h-l,l,l);break;case a.RIGHT:this.ctx.fillRect(n+this.settings.cellSize-4,c+h,l,l),this.ctx.fillRect(n+this.settings.cellSize-4,c+this.settings.cellSize-h-l,l,l);break}}else this.ctx.fillStyle="#228B22",this.ctx.fillRect(n+1,c+1,this.settings.cellSize-2,this.settings.cellSize-2)});const e=this.state.food.x*this.settings.cellSize,t=this.state.food.y*this.settings.cellSize;this.ctx.fillStyle="#FF4444",this.ctx.fillRect(e+2,t+2,this.settings.cellSize-4,this.settings.cellSize-4),this.ctx.fillStyle="#FF8888",this.ctx.fillRect(e+3,t+3,this.settings.cellSize-8,this.settings.cellSize-8)}}class S{constructor(){this.audioContext=null,this.enabled=!0,this.initAudioContext()}initAudioContext(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch{console.warn("Web Audio API not supported")}}setEnabled(e){this.enabled=e}playTone(e,t,o="square"){if(!this.enabled||!this.audioContext)return;const s=this.audioContext.createOscillator(),n=this.audioContext.createGain();s.connect(n),n.connect(this.audioContext.destination),s.type=o,s.frequency.setValueAtTime(e,this.audioContext.currentTime),n.gain.setValueAtTime(.1,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+t),s.start(this.audioContext.currentTime),s.stop(this.audioContext.currentTime+t)}playMove(){this.playTone(220,.1)}playEat(){this.playTone(440,.2)}playGameOver(){this.playTone(110,.5),setTimeout(()=>this.playTone(98,.5),200)}playMenuSelect(){this.playTone(330,.1)}}const g="http://localhost:5102/api";class y{async getLeaderboard(e=10){try{const t=await fetch(`${g}/leaderboard?limit=${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){return console.error("Failed to fetch leaderboard:",t),[]}}async submitScore(e,t){try{return(await fetch(`${g}/leaderboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,score:t})})).ok}catch(o){return console.error("Failed to submit score:",o),!1}}}const u=class u{static getHighScore(){const e=localStorage.getItem(this.HIGH_SCORE_KEY);return e?parseInt(e,10):0}static setHighScore(e){localStorage.setItem(this.HIGH_SCORE_KEY,e.toString())}static getSettings(){const e=localStorage.getItem(this.SETTINGS_KEY);return e?JSON.parse(e):{speed:8,wallMode:"solid",soundEnabled:!0}}static setSettings(e){localStorage.setItem(this.SETTINGS_KEY,JSON.stringify(e))}};u.HIGH_SCORE_KEY="snake-high-score",u.SETTINGS_KEY="snake-settings";let d=u;class E{constructor(){this.currentScreen=i.MENU,this.soundManager=new S,this.apiClient=new y;const e=d.getSettings();this.settings={gridSize:20,cellSize:20,canvasWidth:400,canvasHeight:400,initialSpeed:e.speed||8,wallMode:e.wallMode||"solid",soundEnabled:e.soundEnabled??!0},this.highScore=d.getHighScore(),this.initializeElements(),this.initializeGame(),this.setupEventListeners(),this.updateUI(),this.showScreen(i.MENU)}initializeElements(){this.elements={canvas:document.getElementById("game-canvas"),score:document.getElementById("score"),highScore:document.getElementById("high-score"),menuScreen:document.getElementById("menu-screen"),optionsScreen:document.getElementById("options-screen"),gameOverScreen:document.getElementById("game-over-screen"),leaderboardScreen:document.getElementById("leaderboard-screen"),pauseScreen:document.getElementById("pause-screen"),playBtn:document.getElementById("play-btn"),optionsBtn:document.getElementById("options-btn"),leaderboardBtn:document.getElementById("leaderboard-btn"),backBtn:document.getElementById("back-btn"),leaderboardBackBtn:document.getElementById("leaderboard-back-btn"),speedSelect:document.getElementById("speed-select"),wallsSelect:document.getElementById("walls-select"),soundToggle:document.getElementById("sound-toggle"),finalScore:document.getElementById("final-score"),highScoreMsg:document.getElementById("high-score-msg"),playerName:document.getElementById("player-name"),submitScoreBtn:document.getElementById("submit-score-btn"),playAgainBtn:document.getElementById("play-again-btn"),mainMenuBtn:document.getElementById("main-menu-btn"),leaderboardList:document.getElementById("leaderboard-list"),pauseBtn:document.getElementById("pause-btn"),upBtn:document.getElementById("up-btn"),downBtn:document.getElementById("down-btn"),leftBtn:document.getElementById("left-btn"),rightBtn:document.getElementById("right-btn")}}initializeGame(){this.game=new p(this.elements.canvas,this.settings),this.soundManager.setEnabled(this.settings.soundEnabled)}setupEventListeners(){this.elements.playBtn.addEventListener("click",()=>this.startGame()),this.elements.optionsBtn.addEventListener("click",()=>this.showOptions()),this.elements.leaderboardBtn.addEventListener("click",()=>this.showLeaderboard()),this.elements.backBtn.addEventListener("click",()=>this.showScreen(i.MENU)),this.elements.leaderboardBackBtn.addEventListener("click",()=>this.showScreen(i.MENU)),this.elements.playAgainBtn.addEventListener("click",()=>this.startGame()),this.elements.mainMenuBtn.addEventListener("click",()=>this.showScreen(i.MENU)),this.elements.submitScoreBtn.addEventListener("click",()=>this.submitScore()),this.elements.pauseBtn.addEventListener("click",()=>this.togglePause()),this.elements.upBtn.addEventListener("click",()=>this.changeDirection(a.UP)),this.elements.downBtn.addEventListener("click",()=>this.changeDirection(a.DOWN)),this.elements.leftBtn.addEventListener("click",()=>this.changeDirection(a.LEFT)),this.elements.rightBtn.addEventListener("click",()=>this.changeDirection(a.RIGHT)),this.elements.speedSelect.addEventListener("change",()=>this.updateSettings()),this.elements.wallsSelect.addEventListener("change",()=>this.updateSettings()),this.elements.soundToggle.addEventListener("change",()=>this.updateSettings()),document.addEventListener("keydown",e=>this.handleKeyPress(e)),document.querySelectorAll(".control-btn").forEach(e=>{e.addEventListener("contextmenu",t=>t.preventDefault())})}handleKeyPress(e){switch(e.code){case"ArrowUp":case"KeyW":e.preventDefault(),this.changeDirection(a.UP);break;case"ArrowDown":case"KeyS":e.preventDefault(),this.changeDirection(a.DOWN);break;case"ArrowLeft":case"KeyA":e.preventDefault(),this.changeDirection(a.LEFT);break;case"ArrowRight":case"KeyD":e.preventDefault(),this.changeDirection(a.RIGHT);break;case"Space":e.preventDefault(),(this.currentScreen===i.GAME||this.currentScreen===i.PAUSE)&&this.togglePause();break;case"Enter":e.preventDefault(),this.currentScreen===i.MENU&&this.startGame();break;case"Escape":e.preventDefault(),this.currentScreen===i.GAME?this.togglePause():this.currentScreen!==i.MENU&&this.showScreen(i.MENU);break}}changeDirection(e){this.currentScreen===i.GAME&&(this.game.changeDirection(e),this.soundManager.playMove())}startGame(){this.soundManager.playMenuSelect(),this.game.reset(),this.game.start(),this.showScreen(i.GAME),this.gameLoop()}async gameLoop(){if(this.currentScreen!==i.GAME)return;const e=this.game.getState();if(e.isGameOver){this.handleGameOver(e.score);return}this.updateScore(e.score),setTimeout(()=>this.gameLoop(),50)}handleGameOver(e){this.soundManager.playGameOver(),e>this.highScore?(this.highScore=e,d.setHighScore(this.highScore),this.elements.highScoreMsg.style.display="block",this.elements.playerName.style.display="block",this.elements.submitScoreBtn.style.display="block"):(this.elements.highScoreMsg.style.display="none",this.elements.playerName.style.display="none",this.elements.submitScoreBtn.style.display="none"),this.elements.finalScore.textContent=`Score: ${e}`,this.updateUI(),this.showScreen(i.GAME_OVER)}async submitScore(){const e=this.elements.playerName.value.trim();if(!e)return;const t=this.game.getState().score;await this.apiClient.submitScore(e,t)?(this.elements.submitScoreBtn.textContent="SUBMITTED!",this.elements.submitScoreBtn.disabled=!0,this.soundManager.playMenuSelect()):(this.elements.submitScoreBtn.textContent="FAILED",setTimeout(()=>{this.elements.submitScoreBtn.textContent="SUBMIT"},2e3))}togglePause(){this.currentScreen===i.GAME?(this.game.pause(),this.showScreen(i.PAUSE)):this.currentScreen===i.PAUSE&&(this.game.resume(),this.showScreen(i.GAME),this.gameLoop())}showOptions(){this.soundManager.playMenuSelect(),this.elements.speedSelect.value=this.settings.initialSpeed.toString(),this.elements.wallsSelect.value=this.settings.wallMode,this.elements.soundToggle.checked=this.settings.soundEnabled,this.showScreen(i.OPTIONS)}updateSettings(){this.settings.initialSpeed=parseInt(this.elements.speedSelect.value),this.settings.wallMode=this.elements.wallsSelect.value,this.settings.soundEnabled=this.elements.soundToggle.checked,this.game.updateSettings(this.settings),this.soundManager.setEnabled(this.settings.soundEnabled),d.setSettings({speed:this.settings.initialSpeed,wallMode:this.settings.wallMode,soundEnabled:this.settings.soundEnabled}),this.soundManager.playMenuSelect()}async showLeaderboard(){this.soundManager.playMenuSelect(),this.elements.leaderboardList.innerHTML="<div>Loading...</div>",this.showScreen(i.LEADERBOARD);const e=await this.apiClient.getLeaderboard();this.renderLeaderboard(e)}renderLeaderboard(e){if(e.length===0){this.elements.leaderboardList.innerHTML="<div>No scores yet!</div>";return}const t=e.map((o,s)=>`
      <div class="leaderboard-entry">
        <span class="leaderboard-rank">${s+1}.</span>
        <span class="leaderboard-name">${o.name}</span>
        <span class="leaderboard-score">${o.score}</span>
      </div>
    `).join("");this.elements.leaderboardList.innerHTML=t}showScreen(e){switch(this.currentScreen=e,this.elements.menuScreen.style.display="none",this.elements.optionsScreen.style.display="none",this.elements.gameOverScreen.style.display="none",this.elements.leaderboardScreen.style.display="none",this.elements.pauseScreen.style.display="none",e){case i.MENU:this.elements.menuScreen.style.display="flex";break;case i.OPTIONS:this.elements.optionsScreen.style.display="flex";break;case i.GAME_OVER:this.elements.gameOverScreen.style.display="flex";break;case i.LEADERBOARD:this.elements.leaderboardScreen.style.display="flex";break;case i.PAUSE:this.elements.pauseScreen.style.display="flex";break;case i.GAME:break}}updateScore(e){this.elements.score.textContent=e.toString()}updateUI(){this.elements.highScore.textContent=this.highScore.toString()}}document.addEventListener("DOMContentLoaded",()=>{new E});document.addEventListener("touchstart",r=>{r.touches.length>1&&r.preventDefault()});let m=0;document.addEventListener("touchend",r=>{const e=Date.now();e-m<=300&&r.preventDefault(),m=e},!1);
//# sourceMappingURL=index-CyBE2j4C.js.map
